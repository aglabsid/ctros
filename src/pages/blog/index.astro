---
import { getCollection } from 'astro:content'
import RootLayout from '@/layouts/root-layout.astro'
import PostCard from '@/components/post-card.astro'

const posts = await getCollection('post')

// Sort by createdAt descending
const sortedPosts = posts.sort(
	(a, b) =>
		new Date(b.data.createdAt).getTime() - new Date(a.data.createdAt).getTime(),
)
---

<RootLayout>
	<main class="mx-auto max-w-5xl border-x">
		<section class="border-b p-6">
			<h1>Blog</h1>
			<p class="mt-2 text-muted-foreground">
				Thoughts, ideas, and explorations I've had.
			</p>
		</section>

		<div class="grid gap-4 p-6">
			{sortedPosts.map((post) => <PostCard post={post} />)}
		</div>

		{
			sortedPosts.length === 0 && (
				<div class="p-6 text-center text-muted-foreground">
					<p>No posts yet. Check back soon!</p>
				</div>
			)
		}
	</main>
</RootLayout>
